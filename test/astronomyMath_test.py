import unittest
import sys

sys.path.insert(0, '../src/')

import numpy as np

import astronomyMath as am


# general class to test the model

class TestStringMethods(unittest.TestCase):
    
    def setUp(self):
        self.vector_days = [i for i in range(365)]
        self.year = 2002

        self.SDA = [am.solar_declination_angle(self.year, i) \
                for i in self.vector_days]
        
        self.EOT = [am.equation_of_time(self.year, i) \
                for i in self.vector_days]

        self.SDA_external = [-0.4029850405871777, -0.4016321217886543, -0.40014571821306744, 
                            -0.3985265556163159, -0.39677542570372154, -0.3948931848470109, 
                            -0.39288075271048434, -0.3907391107921711, -0.3884693008860168, 
                            -0.38607242347135423, -0.3835496360360966, -0.38090215134019234, 
                            -0.37813123562598083, -0.3752382067821289, -0.3722244324678072, 
                            -0.3690913282037635, -0.3658403554368425, -0.3624730195843949, 
                            -0.35899086806490754, -0.35539548832096957, -0.3516885058405176, 
                            -0.3478715821820764, -0.34394641300946005, -0.33991472614112833, 
                            -0.3357782796191443, -0.3315388598023362, -0.32719827948802205, 
                            -0.32275837606630436, -0.3182210097106292, -0.31358806160803854, 
                            -0.30886143223215295, -0.30404303966166946, -0.29913481794682034, 
                            -0.29413871552594323, -0.2890566936940163, -0.2838907251247285, 
                            -0.27864279244737616, -0.27331488687959116, -0.267909006916712, 
                            -0.26242715707828757, -0.2568713467120397, -0.2512435888553656, 
                            -0.2455458991542791, -0.2397802948394711, -0.23394879375905098, 
                            -0.22805341346731525, -0.22209617036877294, -0.21607907891655223, 
                            -0.2100041508641163, -0.2038733945692003, -0.19768881434872884, 
                            -0.19145240988340076, -0.18516617567057142, -0.17883210052398738, 
                            -0.17245216711887792, -0.166028351580869, -0.15956262311714242, 
                            -0.1530569436882428, -0.14651326771890835, -0.13993354184630538, 
                            -0.13331970470399676, -0.12667368674003707, -0.11999741006751123, 
                            -0.113292788345923, -0.1065617266917595, -0.09980612161668113, 
                            -0.09302786099167716, -0.08622882403565325, -0.07941088132687744, 
                            -0.07257589483575609, -0.06572571797742116, -0.05886219568264664, 
                            -0.05198716448564178, -0.045102452627255735, -0.03820988017221967, 
                            -0.03131125913901174, -0.024408393640987968, -0.017503080037461243, 
                            -0.010597107093389355, -0.0036922561464040153, 0.0032096987201169387, 
                            0.01010699049912871, 0.01699785907844141, 0.02388055105683794, 
                            0.030753319559000465, 0.037614424050415485, 0.044462130153414034, 
                            0.0512947094654742, 0.05811043938093579, 0.06490760291720724, 
                            0.07168448854660564, 0.07843939003487678, 0.08517060628751953, 
                            0.09187644120492607, 0.09855520354746135, 0.10520520681147741, 
                            0.11182476911732633, 0.11841221311040961, 0.12496586587625871, 
                            0.1314840588706946, 0.1379651278660234, 0.1444074129143118, 
                            0.15080925832866834, 0.15716901268353137, 0.1634850288349009, 
                            0.16975566396145847, 0.17597927962747162, 0.1821542418684097, 
                            0.18827892130011725, 0.1943516932524222, 0.2003709379279766, 
                            0.20633504058712693, 0.21224239175958892, 0.21809138748362272, 
                            0.2238804295733909, 0.22960792591514054, 0.23527229079278028, 
                            0.2408719452433767, 0.24640531744305047, 0.2518708431236567, 
                            0.2572669660205988, 0.26259213835202433, 0.26784482132958853, 
                            0.2730234857008722, 0.27812661232347013, 0.283152692770652, 
                            0.28810022996840245, 0.2929677388635535, 0.29775374712258956, 
                            0.30245679586061774, 0.3070754403998391, 0.31160825105679846, 
                            0.3160538139574547, 0.3204107318791288, 0.3246776251180932, 
                            0.32885313238158376, 0.3329359117027531, 0.3369246413770284, 
                            0.3408180209181618, 0.3446147720321426, 0.34831363960698014, 
                            0.35191339271626476, 0.35541282563426607, 0.3588107588602092, 
                            0.36210604014924824, 0.3652975455475334, 0.3683841804286991, 
                            0.3713648805289556, 0.37423861297791255, 0.37700437732217906, 
                            0.3796612065387158, 0.3822081680348636, 0.3846443646319435, 
                            0.386968935529283, 0.38918105724552826, 0.39127994453410153, 
                            0.3932648512696845, 0.39513507130265124, 0.3968899392784216, 
                            0.3985288314187969, 0.4000511662624027, 0.4014564053614895, 
                            0.40274405393246354, 0.40391366145764757, 0.40496482223593816,
                             0.40589717588018687, 0.40671040775932404, 0.4074042493834322, 
                             0.4079784787301892, 0.4084329205113216, 0.40876744637792906, 
                             0.40898197506378786, 0.40907647246597095, 0.40905095166238037, 
                             0.4089054728660289, 0.40864014331616283, 0.40825511710656776, 
                             0.4077505949516459, 0.4071268238911011, 0.40638409693430194, 
                             0.405522752645631, 0.4045431746723482, 0.40344579121670715, 
                             0.4022310744542743, 0.4008995399005821, 0.399451745728424, 
                             0.3978882920382679, 0.39620982008440286, 0.3944170114595665, 
                             0.39251058724092175, 0.39049130710033364, 0.38835996838198783, 
                             0.3861174051504619, 0.3837644872123822, 0.381302119114854, 
                             0.3787312391238566, 0.37605281818577413, 0.3732678588752519, 
                             0.3703773943324959, 0.3673824871931014, 0.3642842285134544, 
                             0.36108373669463767, 0.3577821564077251, 0.35438065752323733,
                              0.3508804340474234, 0.34728270306793885, 0.3435887037113565, 
                              0.3397996961148348, 0.3359169604141188, 0.3319417957499398, 
                              0.32787551929473197, 0.3237194653014439, 0.3194749841760699, 
                              0.31514344157544444, 0.3107262175315998, 0.3062247056039701, 
                              0.3016403120604885, 0.2969744550885472, 0.292228564036641, 
                              0.2874040786873953, 0.2825024485625428, 0.2775251322603089, 
                              0.2724735968255533, 0.2673493171528974, 0.26215377542295254,
                              0.2568884605717147, 0.2515548677930337, 0.24615449807401263, 
                              0.2406888577631358, 0.23515945817078654, 0.22956781520178196, 
                              0.2239154490195184, 0.21820388374117117, 0.2124346471634344, 
                              0.2066092705181684, 0.2007292882573162, 0.19479623786637867, 
                              0.18881165970572175, 0.18277709687895677, 0.17669409512758677, 
                              0.17056420275109688, 0.16438897055165422, 0.15816995180254945, 
                              0.15190870223946917, 0.1456067800737667, 0.1392657460267419, 
                              0.13288716338406048, 0.12647259806939148, 0.12002361873626245, 
                              0.113541796877261, 0.10702870694958948, 0.10048592651602814, 
                              0.09391503640035047, 0.08731762085623414, 0.08069526774868199,
                               0.07404956874701085, 0.06738211952840556, 0.06069451999109056, 
                               0.053988374476111115, 0.04726529199675346, 0.040526886474608406, 
                               0.033774776981264916, 0.02701058798465358, 0.02023594959899922, 
                               0.01345249783736126, 0.006661874865742098, -0.00013427074230804248, 
                               -0.006934283751638353, -0.013736502013081527, -0.020539256213760196, 
                               -0.027340869631234478, -0.03413965789262701, -0.040933928739855324, 
                               -0.0477219818021583, -0.05450210837711801, -0.06127259122138061, 
                               -0.0680317043523225, -0.07477771286194324, -0.08150887274426433, 
                               -0.08822343073757408, -0.09491962418285405, -0.10159568089978113, 
                               -0.10824981908169992, -0.1148802472110104, -0.12148516399643686, 
                               -0.1280627583336435, -0.13461120929076087, -0.1411286861203123, 
                               -0.1476133482991433, -0.15406334559790813, -0.16047681818174675, 
                               -0.16685189674374143, -0.17318670267280434, -0.17947934825762246, 
                               -0.18572793692829548, -0.19193056353731835, -0.19808531468154117, 
                               -0.2041902690666914, -0.2102434979161122, -0.21624306542521304, 
                               -0.22218702926324646, -0.228073441123815, -0.23390034732560488, 
                               -0.23966578946469289, -0.24536780511969342, -0.2510044286110076, 
                               -0.2565736918152234, -0.2620736250357176, -0.2675022579302883,
                               -0.27285762049659895, -0.27813774411598297, -0.2833406626560644, 
                               -0.28846441363242264, -0.2935070394293624, -0.29846658857962893, 
                               -0.30334111710271056, -0.30812868990110387, -0.3128273822136968, 
                               -0.31743528112515684, -0.32195048712993, -0.32637111574919314, 
                               -0.3306952991987779, -0.3349211881058282, -0.33904695327158935, 
                               -0.343070787477478, -0.34699090733118576, -0.3508055551493327, 
                               -0.3545130008728064, -0.35811154401062945, -0.3615995156079015, 
                               -0.36497528023302883, -0.36823723797919933, -0.37138382647475043, 
                               -0.37441352289684315, -0.3773248459826052, -0.38011635803167615, 
                               -0.3827866668939269, -0.38533442793592126, -0.3877583459795977, 
                               -0.39005717720650324, -0.3922297310208969, -0.39427487186497145, 
                               -0.3961915209794858, -0.3979786581031398, -0.39963532310412736, 
                               -0.4011606175374437, -0.4025537061217018, -0.4038138181294489, 
                               -0.4049402486852323, -0.40593235996598603, -0.40678958229865375, 
                               -0.40751141515035455, -0.4080974280068243, -0.4085472611353263, 
                               -0.40886062622870323, -0.4090373069277699, -0.4090771592197698, 
                               -0.40898011171118254, -0.4087461657737311, -0.40837539556301894,
                               -0.4078679479098059, -0.4072240420845135, -0.40644396943612976, 
                               -0.40552809290724295, -0.40447684642749493]

        self.EOT_external = [3.2791670843448872, 3.7279776165631375, 4.172369755225438, 
                                4.611934162685845, 5.0462671883433945, 5.4749713122836, 
                                5.897655581674499, 6.3139360394102715, 6.7234361445047455, 
                                7.125787183746787, 7.520628674139919, 7.907608755659511, 
                                8.286384573872152, 8.656622651974054, 9.01799925181759, 
                                9.370200723508294, 9.712923843168067, 10.045876138474313, 
                                10.368776201599259, 10.68135398918847, 10.98335110903306, 
                                11.274521093105646, 11.554629656646322, 11.823454943001378, 
                                12.080787753934297, 12.32643176514572, 12.560203726756605, 
                                12.78193364852642, 12.991464969596462, 13.188654712566342, 
                                13.37337362173052, 13.545506285320224, 13.704951241615019, 
                                13.851621068807429, 13.985442458523039, 14.106356272917905, 
                                14.214317585294392, 14.30929570419607, 14.39127418096171, 
                                14.460250800738008, 14.516237556970099, 14.559260609408444, 
                                14.589360225690097, 14.606590706571692, 14.611020294910798, 
                                14.60273106851142, 14.581818816968402, 14.548392902664395, 
                                14.502576106091663, 14.444504455689511, 14.374327042406255, 
                                14.292205819212748, 14.198315385812101, 14.092842758807674, 
                                13.975987127608537, 13.847959596368323, 13.70898291226987, 
                                13.559291180484053, 13.399129566146861, 13.22875398371404, 
                                13.048430774067425, 12.858436369761456, 12.659056948812301, 
                                12.450588077445357, 12.233334342230004, 12.007608972042718, 
                                11.773733450311681, 11.532037118007356, 11.282856767854264, 
                                11.02653623024954, 10.76342595138338, 10.493882564065732, 
                                10.218268451771909, 9.936951306427805, 9.650303680462555, 
                                9.358702533663187, 9.06252877537173, 8.76216680257066, 
                                8.45800403440724, 8.150430443711363, 7.839838086064888, 
                                7.526620626983243, 7.211172867772047, 6.893890270622978, 
                                6.575168483513816, 6.255402865477617, 5.934988012805428, 
                                5.614317286745592, 5.293782343260825, 4.973772665401556, 
                                4.6546750988508, 4.336873391191865, 4.020747735445635, 
                                3.7066743184188864, 3.395024874399275, 3.08616624472607, 
                                2.7804599437585837, 2.478261731756505, 2.179921195177945, 
                                1.8857813348920542, 1.5961781627935032, 1.3114403072960021, 
                                1.0318886281712931, 0.7578358411888706, 0.48958615299979424,
                                0.22743490669572797, -0.028331761538510136, -0.27743725427398047, 
                                -0.5196148327970356, -0.7546079248022632, -0.9821704194567795, 
                                -1.2020669494888176, -1.4140731599691492, -1.6179759634697835, 
                                -1.8135737813007138, -2.0006767705421575, -2.1791070366067187, 
                                -2.348698831083256, -2.509298734631777, -2.660765824716666, 
                                -2.802971827983577, -2.9358012571037646, -3.059151531928146, 
                                -3.17293308481217, -3.277069449991483, -3.3714973369074226, 
                                -3.4561666874005743, -3.5310407167098763, -3.5960959382341056, 
                                -3.651322172032012, -3.696722537056716, -3.7323134271394576, 
                                -3.7581244707572212, -3.7741984746380117, -3.7805913512770086, 
                                -3.777372030455883, -3.7646223548767725, -3.74243696004128, 
                                -3.7109231385237758, -3.670200688806796, -3.6204017488648352, 
                                -3.5616706147009936, -3.4941635440589414, -3.41804854555029, 
                                -3.3335051534549356, -3.240724188468999, -3.139907504691754, 
                                -3.0312677231593863, -2.9150279522494698, -2.7914214952956877, 
                                -2.6606915457676736, -2.5230908703855466, -2.378881480553292, 
                                -2.228334292508946, -2.071728776603055, -1.9093525961299078, 
                                -1.741501236148403, -1.56847762274151, -1.390591733174558, 
                                -1.2081601974235663, -1.0215058915550839, -0.8309575234487236, 
                                -0.6368492113628217, -0.43952005585208553, -0.23931370555411657, 
                                -0.03657791736904503, 0.16833588843688307, 0.3750730776666882, 
                                0.58327625562465, 0.7925857239976524, 1.002639940634515, 
                                1.2130759816685193, 1.4235300054253741, 1.6336377175568604, 
                                1.8430348368388012, 2.051357561071195, 2.2582430325182665, 
                                2.4633298023265553, 2.6662582933605137, 2.8666712608968044, 
                                3.064214250621063, 3.2585360533740966, 3.4492891560982195, 
                                3.6361301884390422, 3.8187203644630867, 3.996725918957387, 
                                4.169818537783739, 4.337675781767137, 4.4999815036058015, 
                                4.656426257298307, 4.8067076995922875, 4.95053098296869, 
                                5.087609139685446, 5.217663456415248, 5.34042383902309, 
                                5.4556291670411134, 5.5630276374103955, 5.662377097072125, 
                                5.753445364003916, 5.836010536310601, 5.909861288993204, 
                                5.974797158034273, 6.030628811453003, 6.077178306998862, 
                                6.114279336168574, 6.141777454247318, 6.159530296091803, 
                                6.167407777389757, 6.165292281147637, 6.15307882917602, 
                                6.130675238359854, 6.098002261518957, 6.054993712682453, 
                                6.001596576619354, 5.937771102486302, 5.863490881472297, 
                                5.778742908339393, 5.683527626777425, 5.577858958510144, 
                                5.461764316109507, 5.33528459949423, 5.198474176108152, 
                                5.051400844793452, 4.894145783393102, 4.726803480136393, 
                                4.549481648880693, 4.362301128301809, 4.165395765144454, 
                                3.9589122816633955, 3.743010127404622, 3.5178613154946206, 
                                3.2836502436242885, 3.0405734999322718, 2.788839654010623, 
                                2.5286690332732418, 2.2602934849453273, 1.9839561239489223, 
                                1.6999110669767319, 1.4084231530628237, 1.1097676509748302, 
                                0.8042299537682753, 0.4921052608588212, 0.17369824798318145, 
                                -0.1506772745659024, -0.48069871503145123, -0.8160350641977567, 
                                -1.1563472698836827, -1.501288621485191, -1.8505051441164753, 
                                -2.2036360018874896, -2.560313909844778, -2.9201655540919793, 
                                -3.282812019596618, -3.64786922518051, -4.014948365182314, 
                                -4.383656357272907, -4.753596295896586, -5.1243679108044,
                                -5.495568030139737, -5.866791047530557, -6.237629392637952, 
                                -6.6076740046063005, -6.976514807856745, -7.343741189662815, 
                                -7.708942478944544, -8.071708425716084, -8.431629680620643, 
                                -8.788298273986403, -9.141308093837516, -9.490255362295162, 
                                -9.83473910980559, -10.17436164663432, -10.508729031068814, 
                                -10.837451533775662, -11.160144097762618, -11.476426793400972, 
                                -11.785925267969326, -12.08827118918622, -12.383102682206003, 
                                -12.670064759559818, -12.948809743531871, -13.21899768046994, 
                                -13.48029674653827, -13.732383644431355, -13.974943990577135, 
                                -14.207672692369712, -14.430274314982999, -14.642463437329038, 
                                -14.843964996737462, -15.03451462194552, -15.213858954002122, 
                                -15.381755954703198, -15.537975202190438, -15.682298173360525, 
                                -15.8145185127473, -15.934442287555331, -16.041888228539477, 
                                -16.136687956441683, -16.218686193713253, -16.287740961268014, 
                                -16.34372376002938, -16.386519737052318, -16.41602783601911, 
                                -16.432160931926433, -16.434845949799495, -16.424023967288182, 
                                -16.399650301018717, -16.361694576593635, -16.310140782152125, 
                                -16.244987305421947, -16.166246954213737, -16.073946960327884, 
                                -15.968128966863658, -15.848848998939882, -15.716177417855858, 
                                -15.570198858740792, -15.411012151759415, -15.238730226960733, 
                                -15.053480002876269, -14.855402258993106, -14.644651492246073, 
                                -14.42139575769236, -14.185816493550167, -13.93810833080179, 
                                -13.678478887579292, -13.407148548569104, -13.124350229689615, 
                                -12.830329128312652, -12.525342459317436, -12.209659177281758, 
                                -11.88355968513158, -11.547335529586515, -11.201289083753498, 
                                -10.845733217236912, -10.480990954147455, -10.107395119406535, 
                                -9.725287973757023, -9.335020837903794, -8.936953706221095, 
                                -8.531454850475432, -8.118900414024587, -7.6996739969649735, 
                                -7.274166232709323, -6.842774356487798, -6.405901766274287,
                                -5.963957576648891, -5.517356166116214, -5.066516718405881, 
                                -4.611862758289885, -4.153821682456888, -3.6928242859897598, 
                                -3.229304284998145, -2.7636978359614095, -2.296443052342332, 
                                -1.8279795190341308, -1.3587478052063393, -0.8891889761172359, 
                                -0.4197441044607716, 0.049146218182377854, 0.5170423692211071, 
                                0.9835061816894619, 1.4481014290745537, 1.910394307773025, 
                                2.3699539166139005, 2.8263527328901272]


    def test_solar_declination_angle(self):
        self.assertListEqual(self.SDA, self.SDA_external)
    
    def test_equation_of_time(self):
        self.assertListEqual(self.EOT, self.EOT_external)
    



if __name__ == '__main__':
    unittest.main()

